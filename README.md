# hse-os-hw3
---
# ИДЗ №3 по предмету "Операционнные системы"

# Курс 2, ПИ, ФКН, НИУ ВШЭ

# Вариант 14, Рахимова Камила Мухаммадовна, БПИ214

---

## *Условие задачи:*

Задача о гостинице – 3 (дамы и джентльмены). В гостинице 10 номеров рассчитаны на одного человека и 15 номеров рассчитаны на двух человек. В гостиницу случайно приходят клиенты–дамы и клиенты–джентльмены, и конечно они могут провести ночь в номере только с представителем своего пола. Если для клиента не находится подходящего номера, он уходит искать ночлег в другое место. Клиенты порождаются динамически и уничтожаются при освобождении номера или уходе из гостиницы при невозможности поселиться. Создать приложение, моделирующее работу гостиницы.

Гостиница — сервер. Каждого гостя реализовать в виде отдельного клиента, порождаемого вручную. Можно запустить скрипт, порождающий сразу множество гостей в фоновом режиме.

---

## *Сценарий решаемой задачи:*

Первым родительским процессом создаётся Администратор, от него уже создаются дочерние -- клиенты. Администратор очень ленивый, поэтому придумал себе несколько специфичных правил для уменьшения количества работы. Во-первых, до 12 ночи он заселяет людей только в люксовые одноместные номера, а после 12 ночи - только в двухместные (а зачем они приходят заселяться так поздно?). Во-вторых, номер комнаты, в которую заселят клиента, выбирает сам клиент. Если выбранная комната оказывается уже занята (или если человека не могут в ней поселить ввиду социально-моральных соображений -- клиентов разного пола не заселяют вместе), то клиента прогоняют. Администратору, конечно, проще и быстрее прогнать клиента, нежели оформлять и заселять в номер. Из-за таких действий его хотят уволить, но пока не могут найти замену.

Собственно, Вы пришли на экскурсию в отель и его работа как раз моделируется в написанной программе.

---

## *Примечания:*

✔️ Условие задания может быть интерпретировано на своё усмотрение, по словам лектора. Моё усмотрение таково: программа с момента запуска и до завершения работы моделирует одну ночь работы отеля. Соответственно клиенты уничтожаются с рассветом (по окончании работы программы) или при уходе из гостиницы по причине отсутствия свободных номеров.

✔️ Единственный аргумент n - количество клиентов, ожидающих заселения - вводится аргументом командной строки при запуске программы. За корректностью вводимых данных должен следить пользователь (т.е. учитывать, что n >= 0).

✔️ В данном варианте нет необходимости в наборе тестовых файлов для понимания работы программы. Результатом моделирования работы гостиницы является описание результатов действий администратора, выводимое программой.

---

## *Отчёт*

Работа выполнена с расчётом на получение оценки в 7/10 баллов.

### ◉ Требования на 4 балла:

Сама программа расположилась [здесь](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/4%20балла/main.c).

✔ Выбранная схема решения:

Множество процессов взаимодействуют с использованием именованных POSIX семафоров. Обмен данными ведется через разделяемую память в стандарте POSIX.

✔ Предусмотрено корректное завершение программы по прерыванию с клавиатуры по соответствующему сигналу (SIGINT или SIGTERM):

```
void sigfunc(int sig) {
    if (sig != SIGINT && sig != SIGTERM) {
        return;
    }
    printf("Пожарная эвакуация!! Всё, всё, пока!\n");
    if(sem_close(semaphore) == -1) {
        perror("can't close semaphore(");
        exit(-1);
    };
    sem_unlink(SEM_NAME);
    sem_unlink(SHM_NAME1);
    sem_unlink(SHM_NAME2);
    exit (10);
}
```

✔ Предусмотрено удаление семафоров и разделяемой памяти по ее завершению любым из способов:

```
sem_unlink(SEM_NAME);
sem_unlink(SHM_NAME1);
sem_unlink(SHM_NAME2);
```

✔ Запускаем программу:

```
~/os-mini-hw1$ gcc -pthread main.c -o main
~/os-mini-hw1$ ./main 50
```

✔ Результат выполнения программы можно увидеть [тут](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/4%20балла/result).

### ◉ Требования на 5 баллов:

Требования, совпадающие с требованиями на более низкую оценку, остались выполненными и в [этой](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/5%20баллов/main.c) программе.

✔ Выбранная схема решения:

Множество процессов взаимодействуют с использованием неименованных POSIX семафоров расположенных в разделяемой памяти. Обмен данными также ведется через разделяемую память в стандарте POSIX.

✔ Запускаем программу:

```
~/os-mini-hw1$ gcc -pthread main.c -o main
~/os-mini-hw1$ ./main 50
```

✔ Результат работы программы можно увидеть [тут](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/5%20баллов/result).

### ◉ Требования на 6 баллов:

Требования, совпадающие с требованиями на более низкую оценку, остались выполненными и в [этой](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/6%20баллов/main.c) программе.

✔ Выбранная схема решения:

Множество процессов взаимодействуют с использованием семафоров в стандарте UNIX SYSTEM V. Обмен данными ведется через разделяемую память в стандарте UNIX SYSTEM V.

✔ Запускаем программу:

```
~/os-mini-hw1$ gcc -pthread main.c -o main
~/os-mini-hw1$ ./main 50
```

✔ Результат работы программы можно увидеть [тут](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/6%20баллов/result).

### ◉ Требования на 7 баллов:

Требования, совпадающие с требованиями на более низкую оценку, остались выполненными и в [этих](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/7%20баллов/program1.c) [программах](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/7%20баллов/program2.c).

✔ Выбранная схема решения:

Множество независимых процессов взаимодействуют с использованием именованных POSIX семафоров. Обмен данными ведется через разделяемую память в стандарте POSIX.

✔ Запускаем программу:

```
~/os-mini-hw1$ gcc -pthread program1.c -o program1
~/os-mini-hw1$ gcc -pthread program2.c -o program2
~/os-mini-hw1$ ./program1 50 & ./program2
```

✔ Результат работы программы можно увидеть [тут](https://github.com/kamilarakhimova/hse-os-hw2/tree/main/7%20баллов/result).
